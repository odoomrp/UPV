<?xml version="1.0" encoding="UTF-8"?>
<openerp>
<data>
	<record model="ir.ui.view" id="simulation_cost_line_tree_view_inh_budgetary">
		<field name="name">simulation.cost.line.tree.view.inh.budgetary</field>
		<field name="model">simulation.cost.line</field>
		<field name="inherit_id" ref="costs_simulator.simulation_cost_line_tree_view"/>
		<field name="arch" type="xml">
			<field name="description" position="after">
				<field name="expense_area_id" />
				<field name="project_financing_id" />
			</field>
			<field name="subtotal_purchase" position="attributes">
				<attribute name="string">Subtotal</attribute>
			</field>
			<field name="template_id" position="after">
				<field name="stage"/>
			</field>
			<field name="template_id" position="replace">
				<field name="template_id" invisible="1" />		
			</field>
			<field name="estimated_margin" position="after">
				<field name="margin_percent"/>				
			</field>
			<field name="estimated_margin" position="replace">
				<field name="estimated_margin" invisible="1" />
            </field>
		</field>
	</record>
	
	
	<record model="ir.ui.view" id="simulation_cost_line_form_view_inh_budgetary">
			<field name="name">simulation.cost.line.form.view.inh.budgetary</field>
			<field name="model">simulation.cost.line</field>
			<field name="priority" eval="10"/>
			<field name="arch" type="xml">
				<form string="Templates">
					<field name="category_ids" invisible="1" />
					<field name="expense_area_ids" invisible="1" />
					<field name="purchase_insale" invisible="1" />
               		<group colspan="4">
               			<separator string="Expense Area" colspan="2"/>
               			<separator string="Project Financing" colspan="2"/>
						<field name="expense_area_id" colspan="2" attrs="{'readonly':[('simulation_cost_state','not in',('draft','inmodif_budgetary'))]}" 
							domain="[('id','in',expense_area_ids[0][2])]" 
 							on_change="onchange_expense_area_id(expense_area_id, simulation_cost_state, simulation_cost_project_id, simulation_cost_id)"/>
						<field name="project_financing_id" colspan="2" 
							context="{'form_view_ref':'onglibre_budgetary.project_financing_form_view_budgetary3','simulation_cost_state':simulation_cost_state,'simulation_cost_project_id':simulation_cost_project_id}"
							domain="[('simulation_cost_line_id','=',active_id),('simulation_cost_line_id','!=',False)]"
							attrs="{'invisible': [('simulation_cost_state','not in',('financing','inmodif_budgetary'))]}" 						
 							on_change="onchange_project_financing_id(project_financing_id)" />
                    </group>
					<group colspan="4" col="10">
						<separator string="Product of Cost" colspan="10"/>
						<field name="product_id" colspan="5" on_change="onchange_product(simulation_cost_id, product_id, type_cost, amount, sale_amount, subtotal_purchase, estimated_date_purchase_completion, subtotal_sale)" />
						<field name="name" colspan="5"/>
						<group string="DescripciÃ³n" colspan="10" col="4">
							<field name="description" nolabel="1" colspan="4" height="30"/>
						</group>
					</group>
					<group colspan="4">	
						<group colspan="4" col="10">
						<field name="supplier_id" colspan="2" attrs="{'invisible': [('type_cost', 'in', ['Task','Amortization'])]}"
 																	  on_change="onchange_supplier(supplier_id, type_cost, product_id, amount, sale_amount, uom_id, estimated_date_purchase_completion, subtotal_purchase, sale_price, subtotal_sale, estimated_margin, benefit)" 
								                                      context="{'search_default_supplier':1,'search_default_customer':0,'default_supplier':1,'default_customer':0}" options="{'quick_create': false}"/>								
						<field name="amount" colspan="2" on_change="onchange_purchase_price_amount(type_cost, amortization_rate, indirect_cost_rate, purchase_price, amount, sale_amount, subtotal_purchase, sale_price, subtotal_sale, estimated_margin, benefit, purchase_insale)" />	
						<field name="uom_id" string="UoM" colspan="2" />
						<field name="purchase_price" colspan="2" on_change="onchange_purchase_price_amount(type_cost, amortization_rate, indirect_cost_rate, purchase_price, amount, sale_amount, subtotal_purchase, sale_price, subtotal_sale, estimated_margin, benefit, purchase_insale)" />
						<field name="subtotal_purchase" string="Subtotal" colspan="2"/>
						</group>
						<group colspan="4" col="8">
						<field name="amortization_rate" colspan="2" attrs="{'invisible': [('type_cost', 'in', ('Purchase','Investment','Subcontracting Services', 'Amortization'))]}" on_change="onchange_rates(type_cost, amortization_rate, indirect_cost_rate, purchase_price, amount, sale_amount, subtotal_purchase, sale_price, subtotal_sale, estimated_margin, benefit, purchase_insale)"/>
						<field name="amortization_cost" colspan="2" attrs="{'invisible': [('type_cost', 'in', ('Purchase','Investment','Subcontracting Services', 'Amortization'))]}"/>
						<field name="indirect_cost_rate" colspan="2" attrs="{'invisible': [('type_cost', 'in', ('Purchase','Investment','Subcontracting Services', 'Amortization'))]}" on_change="onchange_rates(type_cost, amortization_rate, indirect_cost_rate, purchase_price, amount, sale_amount, subtotal_purchase, sale_price, subtotal_sale, estimated_margin, benefit, purchase_insale)"/>
						<field name="indirect_cost" colspan="2" attrs="{'invisible': [('type_cost', 'in', ('Purchase','Investment','Subcontracting Services', 'Amortization'))]}"/>
						</group>
					</group>
					<group colspan="4" col="10">
						<separator colspan="10" string="Cost Prevision"/>
						<field name="estimated_date_purchase_completion" colspan="10"/>
					</group>
					<group colspan="4" col="6">
						<separator colspan="6" string="Type of Cost"/>
						<field name="type_cost" colspan="2" on_change="onchange_type_cost(type_cost)" invisible="1"/>		
						<field name="type2" colspan="2"/>
						<field name="type3" colspan="2"/>
					</group>
					<field name="deductible_iva" invisible="1"/>
					<group colspan="4" col="10" attrs="{'invisible': [('deductible_iva','=',True)]}">
						<separator colspan="10" string="Product of Sale"/>
						<field name="product_sale_id" colspan="10" on_change="onchange_sale_product(product_sale_id, product_id, purchase_price, amount, sale_amount, subtotal_sale, estimated_margin, subtotal_purchase, benefit, amortization_cost, indirect_cost)" />
						<newline/>
						<field name="sale_amount" colspan="2" on_change="onchange_sale_amount(purchase_price, amount, sale_price, sale_amount, subtotal_sale, estimated_margin, subtotal_purchase, benefit, amortization_cost, indirect_cost)"/>
						<field name="sale_price" colspan="2" on_change="onchange_sale_price(purchase_price, amount, sale_amount, sale_price, subtotal_sale, estimated_margin, subtotal_purchase, benefit, amortization_cost, indirect_cost)" />
						<field name="margin_percent" colspan="2" on_change="onchange_margin_percent(margin_percent, estimated_margin, purchase_price, sale_price, amount, sale_amount, subtotal_sale, subtotal_purchase, benefit, amortization_cost, indirect_cost)" /> 
						<field name="subtotal_sale" colspan="2"/>	
						<field name="benefit" colspan="2"/>
					</group>
					<field name="estimated_margin" invisible="1" colspan="2" on_change="onchange_estimated_margin(estimated_margin, purchase_price, sale_price, amount, sale_amount, subtotal_sale, subtotal_purchase, benefit, amortization_cost, indirect_cost)" /> 						
               		<field name="simulation_cost_id" invisible="1"/>
               		<field name="simulation_cost_state" invisible="1"/>
               		<field name="simulation_cost_project_id" invisible="1"/>

				</form>
			</field>
		</record>

	</data>
</openerp>